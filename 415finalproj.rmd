---
title: "415finalproject"
author: "Paul Merica"
date: "November 17, 2019"
output: html_document
---

# Libraries
```{r}

```

```{r}
life = read.csv("Life Expectancy Data.csv", stringsAsFactors = F)

newlife = na.omit(lifeexpect)
newlife = newlife[-c(12,19)]
newlife$Year = as.factor(newlife$Year)
newlife$Status = as.factor(newlife$Status)

names(newlife)[names(newlife) == "Life.expectancy"] = "Life_Expectancy"
names(newlife)[names(newlife) == "Adult.Mortality"] = "Adult_Mortality"
names(newlife)[names(newlife) == "infant.deaths"] = "Infant_Deaths"
names(newlife)[names(newlife) == "percentage.expenditure"] = "Percentage_Expenditure"
names(newlife)[names(newlife) == "Hepatitis.B"] = "HepatitisB"
names(newlife)[names(newlife) == "Total.expenditure"] = "Total_Expenditure"
names(newlife)[names(newlife) == "Income.composition.of.resources"] = "Resource_Income"
```

```{r}
plot(newlife$Life_Expectancy ~ newlife$Status, xlab = "Status", ylab = "Life Expectancy")
plot(newlife$Life_Expectancy ~ newlife$Adult_Mortality, xlab = "Adult Mortality", ylab = "Life Expectancy")
plot(newlife$Life_Expectancy ~ newlife$Infant_Deaths, xlab = "Infant Deaths", ylab = "Life Expectancy")
plot(newlife$Life_Expectancy ~ newlife$Alcohol, xlab = "Alcohol", ylab = "Life Expectancy")
plot(newlife$Life_Expectancy ~ newlife$Percentage_Expenditure, xlab = "Percentage Expenditure", ylab = "Life Expectancy")
plot(newlife$Life_Expectancy ~ newlife$HepatitisB, xlab = "Hepatitis B", ylab = "Life Expectancy")
plot(newlife$Life_Expectancy ~ newlife$Measles, xlab = "Measles", ylab = "Life Expectancy")
plot(newlife$Life_Expectancy ~ newlife$BMI, xlab = "BMI", ylab = "Life Expectancy")
plot(newlife$Life_Expectancy ~ newlife$Polio, xlab = "Polio", ylab = "Life Expectancy")
plot(newlife$Life_Expectancy ~ newlife$Total_Expenditure, xlab = "Total Expenditure", ylab = "Life Expectancy")
plot(newlife$Life_Expectancy ~ newlife$Diphtheria, xlab = "Diphtheria", ylab = "Life Expectancy")
plot(newlife$Life_Expectancy ~ newlife$HIV.AIDS, xlab = "HIV/AIDS", ylab = "Life Expectancy")
plot(newlife$Life_Expectancy ~ newlife$GDP, xlab = "GDP", ylab = "Life Expectancy")
plot(newlife$Life_Expectancy ~ newlife$Population, xlab = "Population", ylab = "Life Expectancy")
plot(newlife$Life_Expectancy ~ newlife$thinness.5.9.years, xlab = "Thinness 5-9 years", ylab = "Life Expectancy")
plot(newlife$Life_Expectancy ~ newlife$Resource_Income, xlab = "Income Composition of Resources", ylab = "Life Expectancy")
plot(newlife$Life_Expectancy ~ newlife$Schooling, xlab = "Schooling", ylab = "Life Expectancy")
summary(lm(Life_Expectancy ~ Status, data = newlife))$r.squared
summary(lm(Life_Expectancy ~ Adult_Mortality, data = newlife))$r.squared
summary(lm(Life_Expectancy ~ BMI, data = newlife))$r.squared
summary(lm(Life_Expectancy ~ Polio, data = newlife))$r.squared
summary(lm(Life_Expectancy ~ Diphtheria, data = newlife))$r.squared
summary(lm(Life_Expectancy ~ HIV.AIDS, data = newlife))$r.squared
summary(lm(Life_Expectancy ~ Resource_Income, data = newlife))$r.squared
summary(lm(Life_Expectancy ~ Schooling, data = newlife))$r.squared
```

When plotting all the predictors against life expectancy in a scatter plot, life expectancy seems to be most correlated with status of the country, adult mortality, BMI, polio immunization coverage (%), diphtheria,  HIV/AIDS, income composition of resources, and schooling. In most of the scatterplots, there appears to be a lot of outliers. However, this may be due to getting rid of the NA values in the data set in the data cleaning process. When looking at Pearson's r-squared for the relationship between these 8 predictors and life expectancy, the five most correlated features with life expectancy are adult mortality, BMI, HIV/AIDS, income composition of resources, and schooling.

```{r}
mod1 = lm(Life_Expectancy ~ Adult_Mortality + BMI + HIV.AIDS + Resource_Income + Schooling, data = newlife)
summary(mod1)

trainlife<- life[1:floor(0.7*nrow(life)),]
testlife <- life[-(1:floor(0.7*nrow(life))),]

#scale data
```

